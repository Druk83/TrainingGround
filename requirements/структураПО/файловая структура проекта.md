
# Файловая структура проекта

Документ фиксирует рекомендуемую структуру репозитория «Русский язык: тренировочный полигон». Цель — обеспечить единый порядок размещения исходников, конфигураций, тестов и инфраструктуры. Стек минималистичен: PWA на чистом TypeScript, Rust API, Python-сервис, Docker-компоуз для запуска. Kubernetes не используется.

```
TrainingGround/
├── README.md
├── docs/                      # Публикуемые документы и диаграммы
│   ├── requirements/          # Сгенерированные или экспортированные спецификации (копия из /requirements)
│   ├── issues_tasks/          # Проблемы и задачи
│   ├── architecture/          # Диаграммы ArchiMate, схемы данных
│   ├── api/                   # OpenAPI/JSON Schema для REST и Explanation API
│   └── dev-setup.md           # Инструкции по развёртыванию
├── frontend/                 # PWA на чистом TypeScript + Web Components
│   ├── package.json
│   ├── tsconfig.json
│   ├── src/
│   │   ├── components/        # Web Components
│   │   ├── pages/             # Экраны (урок, статистика, админка)
│   │   ├── state/             # Сервисы состояния, JWT, feature flags
│   │   ├── services/          # HTTP/SSE-клиенты
│   │   └── sw/                # Service Worker, Cache стратегии
│   ├── public/                # manifest.json, иконки
│   ├── tests/                 # Vitest/@web/test-runner
│   └── esbuild.config.mjs
├── backend/                  # Серверные компоненты (Rust API, Python генератор)
│   ├── rust-api/
│   │   ├── Cargo.toml
│   │   ├── Cargo.lock
│   │   └── src/
│   │       ├── main.rs        # Точка входа, инициализация роутов/DI
│   │       ├── config/        # Парсинг .env, конфиги Mongo/Redis/Qdrant
│   │       ├── routes/        # Определение REST/SSE/WebSocket маршрутов
│   │       ├── services/      # SessionManager, Scoring, HintService
│   │       ├── models/        # DTO + Mongo/Redis адаптеры
│   │       └── middleware/    # Авторизация, rate limiting, логирование
│   └── python-generator/      # Сервис генерации, объяснений и эмбеддингов
│       ├── pyproject.toml / requirements.txt
│       ├── src/
│       │   ├── app/           # REST (aiohttp) эндпойнты
│       │   ├── embeddings/    # Pipeline Qdrant
│       │   ├── explanation/   # RAG + YandexGPT
│       │   └── jobs/          # Scheduler, cron-задачи, обработка очередей
│       └── tests/
├── services/                 # Дополнительные сервисы/утилиты
│   ├── analytics-worker/      # (если нужен отдельный сервис) скрипты агрегации
│   └── scripts/               # Разовые скрипты миграций/данных
├── infra/                    # Docker-compose, конфиги БД/кеша, скрипты деплоя
│   ├── docker-compose.yml     # Запуск всех сервисов локально (Mongo, Redis, Qdrant, Rust, Python, frontend)
│   ├── docker/                # Dockerfile для front/rust/python
│   ├── config/
│   │   ├── mongo-init/        # Скрипты создания индексов
│   │   ├── redis/             # redis.conf, Lua-скрипты
│   │   └── qdrant/            # Конфигурация коллекций
│   ├── scripts/
│   │   ├── deploy.sh          # Деплой на сервер (ssh + systemd)
│   │   └── backup.sh          # Бэкапы Mongo/Redis/Qdrant
│   └── monitoring/
│       ├── prometheus.yml
│       └── grafana-dashboards/ (опционально)
├── requirements/             # Исходные требования и спецификации              # Исходные требования и спецификации
├── .github/workflows/        # CI/CD (lint/test/build/deploy)         # CI/CD (lint/test/build/deploy)
├── .env.example              # Пример переменных окружения               # Пример переменных окружения
└── Makefile / taskfile.yml   # Команды для сборки/тестов    # Команды для сборки/тестов
```

## Примечания
- **Frontend**: esbuild как единственный сборщик. dev-server запускается через `npm run dev` (esbuild serve).  
- **Backend**: Rust API и Python-сервис разделены; связи (OpenAPI, JSON Schema) лежат в `docs/api`.  
- **Infra**: Используется docker-compose для локального запуска и прод-окружений (через systemd/Compose). Kubernetes/Helm отсутствуют.  
- **Secrets**: Переменные окружения хранятся в `.env` (локально) и в Vault/Secret Manager на прод.  
- **Tests**: Собраны в каталогах `tests/` каждого компонента.  
- **Data**: вспомогательные CSV/fixtures складываются в `data/` (при необходимости).  
- **Feature Flags**: JSON/seed-данные для `feature_flags` коллекции хранятся в `infra/config/seed/`.  
- **Документация**: всё, что публикуется в `/requirements`, дублируется в `docs/requirements` для удобства команды (read-only).

Любые отклонения от структуры должны обсуждаться и фиксироваться через PR/архитектурное решение.
