
# Зависимости проекта «Русский язык: тренировочный полигон»

Документ фиксирует программные и инфраструктурные зависимости, используемые в клиентском, серверном и сервисном коде. Включает обязательные версии и назначение. Любое обновление библиотек должно сопровождаться обновлением этого файла и соответствующего `package-lock`/`Cargo.lock`/`requirements.txt`.

---

## 1. Фронтенд (PWA, TypeScript)

| Пакет / технология | Версия | Назначение / примечания |
|--------------------|--------|-------------------------|
| Node.js | 22.x LTS | Сборка PWA (Vite/esbuild). |
| TypeScript | 5.x | Строгая типизация компонентов. |
| esbuild | 0.21.x | Единственный транспайлер/бандлер (CLI + watch mode), без дополнительных дев-серверов. |
| ESLint + Prettier | latest | Линтер/форматирование. |
| Vitest + @web/test-runner | 1.x | Unit тесты компонентов и сервис-воркера. |
| Service Worker (custom) | - | Реализуется вручную, без Workbox. |
| Native Fetch API | - | Сетевые вызовы без сторонних клиентов. |

---

## 2. Игровой API (Rust)

| Зависимость | Версия | Назначение |
|-------------|--------|-----------|
| Rust toolchain | 1.80+ (edition 2021) | Компилятор. |
| `axum` / `hyper` | 0.7 / 1.0 | HTTP-сервер, router. |
| `tokio` | 1.x | Async runtime. |
| `serde` / `serde_json` | 1.x | Сериализация JSON. |
| `mongodb` crate | 3.x | Доступ к MongoDB. |
| `redis` crate | 0.25+ | Работа с Redis (pub/sub, Lua, Streams). |
| `reqwest` | 0.12 | HTTP-клиент (вызовы Python сервиса, Qdrant). |
| `opentelemetry`, `tracing` | 0.21 | Логирование/метрики. |
| `jsonwebtoken` | 9.x | Проверка JWT. |
| `tower` / `tower-http` | 0.4 / 0.5 | Middleware (rate limiting, CORS). |
| `anyhow` / `thiserror` | 1.x | Ошибки. |

---

## 3. Python-сервис (генерация, объяснения, эмбеддинги)

| Зависимость | Версия | Назначение |
|-------------|--------|-----------|
| Python | 3.12 | Runtime. |
| aiohttp (server/client) | 3.9 | Лёгкий REST API на `asyncio`, без фреймворков. |
| `pydantic` | 2.x | Валидация моделей. |
| `httpx` | 0.27 | Клиент к YandexGPT/внешним API. |
| `sentence-transformers` / `fasttext` | latest | Векторизация текста. |
| `pymorphy2`, `natasha` | latest | Морфологический анализ. |
| `redis` (python) | 5.x | Работа с Redis Streams/кешем. |
| `qdrant-client` | 1.8+ | REST/gRPC клиент Qdrant. |
| `apscheduler` | 3.10 | Планирование задач (обновления, эмбеддинги). |
| `pytest`, `mypy`, `ruff` | latest | Тесты и статическая проверка. |

---

## 4. Базы данных и инфраструктура

| Сервис | Версия | Примечания |
|--------|--------|------------|
| MongoDB | 6.x | Replica Set, WiredTiger. |
| Redis | 7.x | Cluster mode, Redis Streams. |
| Qdrant | 1.8+ | HNSW, REST/gRPC. |
| Object Storage | S3-совместимый | Backups PWA, MongoDB, Qdrant. |
| Prometheus | 2.50+ | Метрики. |
| Grafana | 10.x | Дашборды. |
| Loki / ELK | latest | Логи. |
| Nginx / Ingress Controller | 1.25+ | Balancer + TLS. |
| Docker Engine | 24+ | Контейнеризация. |
| Kubernetes / YaCloud Serverless Containers | 1.29+ | Оркестрация. |
| GitHub Actions | SaaS | CI/CD. |
| HashiCorp Vault | 1.15+ | Secrets Manager. |

---

## 5. Внешние API и сервисы

| Сервис | Назначение | Примечания |
|--------|------------|------------|
| YandexGPT API | Генерация заданий/пояснений | REST, авторизация по API Key, SLA 2 сек, fallback в шаблоны. |
| OAuth2/SAML провайдеры школ | SSO | Интеграция с дневниками (опционально). |
| SMTP / Telegram Bot API | Отправка уведомлений, отчётов | Конкретные провайдеры уточняются при внедрении. |
| CDN (CloudFront / YaCDN) | Раздача PWA | TLS 1.3, cache invalidation ≤ 5 мин. |

---

## 6. Управление версиями и пакетами

- **Frontend:** `package.json` + `pnpm-lock.yaml` или `yarn.lock` (в зависимости от выбранного менеджера).  
- **Rust:** `Cargo.toml` + `Cargo.lock`.  
- **Python:** `pyproject.toml` + `poetry.lock` или `requirements.txt` + `requirements.lock`.  
- **Docker:** `Dockerfile` для каждого сервиса; образы публикуются в приватный реестр (`registry.example.com/mishagame/*`).  
- **IaC:** Terraform modules + Helm charts (с версиями в `charts/Chart.yaml`).  
- **Мониторинг:** Grafana dashboards хранятся в `infra/monitoring/dashboards/*.json`.

Документ обновляется при добавлении/замене пакета или сервисной зависимости. Для всех сторонних сервисов необходимо иметь учетные записи в `docs/access.md`.
