# A6-02-2 — Приведение UI прохождения курса к требованиям

## Контекст
Завершение A6‑02 показало, что в «ученическом» интерфейсе остались отладочные элементы и заглушки, которые противоречат сценариям из `requirements/сценарии/требования.md` (п. 4.2.1 «Выбор курса и запуск уровня») и «Паспорту проекта» (`requirements/sources/паспорт.md`, раздел «Правила игры»). После логина ученик должен видеть только каталог курсов, таймер, поле ответа, подсказки и понятный прогресс. Сейчас же DOM (`app-shell` → `lesson-player`) содержит формы для ручного ввода `userId/groupId/JWT`, панель синхронизации Redis, дублирующиеся уведомления и псевдо-данные в каталоге.

## Цель
Очистить UI прохождения курса от отладочных блоков, подтянуть реальные данные о курсах и привести поведение компонентов к требованиям документации: один поток уведомлений, явный прогресс по заданиям и вывод пояснений после проверки.

## Требования и изменения
1. **Убрать debug-формы.**
   - Удалить `<form>` с полями `ID ученика / ID группы / JWT` из `app-shell.ts`. Пользователь/токен берутся из `authService` + `lessonStore.setUser()` после логина.
2. **Переработать сайдбар.**
   - `lesson-catalog` должен отображать данные из `lessonStore.snapshot.lessons` (название, описание, прогресс), текста — нормальный русский (слова вроде «Сложность», «Уровней», «Статус»).
   - `connection-indicator`: свернуть в компактный блок (статус онлайн/оффлайн и размер очереди). Панель конфликтов показывать только если `state.connection.conflicts > 0`, в остальном скрывать или выносить в отдельный экран.
3. **Каталог курсов без моков.**
   - Подтянуть реальные курсы, которые приходят из `/student/courses` (см. `student-home.ts`). Убрать статичные «Грамматические основы» и т.п.
4. **Счётчик задания/уровня.**
   - В `lesson-player.ts` добавить отображение «Задание X из Y». Передавать `currentIndex/total` из `lessonStore` (если нет — вычислять по истории попыток).
5. **Question renderer и фидбек.**
   - После отправки ответа блокировать кнопку до ответа API и выводить одно уведомление рядом с формой («Ответ верный/неверный + пояснение»). Использовать `SubmitAnswerResponse.feedback` или данные из `lesson-results`.
6. **`lesson-results`.**
   - Показывать карточки (баллы/точность/серия) и кнопки «Повторить урок» / «Вернуться к курсам» только когда урок завершён или таймер истёк. Пока урок активен — компонент не должен занимать место.
7. **Уведомления.**
   - Удалить `div.toast` и оставить единственный канал обратной связи (под scoreboard или рядом с кнопкой отправки), чтобы выполнить требование 4.4.7 («не более одного всплывающего окна»).
8. **Документация.**
   - Обновить `tasks/done/A6-02.md`, добавив ссылку на п. 4.2.1 требований и отметку, что debug-блоки убраны.

## Acceptance criteria
- После логина UI показывает каталог реальных курсов; нет полей `userId/groupId/JWT`.
- Сайдбар содержит нормальные русские подписи и компактный индикатор связи, панель конфликтов появляется только при реальном конфликтах.
- `lesson-player` показывает счётчик задания и единственный канал уведомлений; после ответа выводится пояснение, а `lesson-results` появляется только по завершении.
- Нет дублирующих `<p>` с уведомлениями и `toast`-контейнера.
- `tasks/done/A6-02.md` дополняется описанием изменений.

## Выполнено 05.01.2026
- `lessonStore` теперь подтягивает курсы из `/student/courses`, хранит прогресс по шагам (`sessionProgress`) и использует `startStudentSession` при запуске урока из каталога (`frontend/src/lib/session-store.ts`). Фидбек от API выводится единым уведомлением возле формы.
- Сайдбар очищен от QA-форм: `lesson-catalog` показывает реальный список и отдельную карточку текущего курса, а также позволяет мгновенно вернуться к активному уроку (`frontend/src/components/lesson-catalog.ts`). `connection-indicator` больше не застревает в статусе «Синхронизация…».
- В `lesson-player` добавлены кнопка возврата к каталогу, блокировка отправки во время ожидания и счётчик «Задание X из Y» через новое свойство `progress` (`frontend/src/components/lesson-player.ts`, `frontend/src/app-shell.ts`).
- После прохождения тест-кейса `tasks/done/A6-02.md` дополнён ссылкой на требования 4.2.1 и описанием, что отладочные поля удалены.
